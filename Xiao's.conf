# xiao's conf
# update date: 2023-03-01 09:56

[General]
# 测速
internet-test-url = http://g.alicdn.com
proxy-test-url = http://1.1.1.1/generate_204
test-timeout = 3
# Wi-Fi助理
wifi-assist = true
allow-wifi-access = true
all-hybrid = false
# GeoIP
geoip-maxmind-url = https://raw.githubusercontent.com/NobyDa/geoip/release/Private-GeoIP.mmdb
disable-geoip-db-auto-update = false
# ipv6
ipv6 = true
ipv6-vif = auto
# 隐藏VPN图标
hide-vpn-icon = false
fast-switch = false
# Wi-Fi 访问
allow-hotspot-access = true
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153
http-listen = 0.0.0.0
socks5-listen = 0.0.0.0
external-controller-access = 3694304@127.0.0.1:6155
# 远程控制器
http-api-tls = false
http-api-web-dashboard = false
http-api = 3694304@0.0.0.0:6171
# 兼容性（仅iOS）
compatibility-mode = 0
# DNS
dns-server = 119.29.29.29, 223.5.5.5, system
encrypted-dns-server = h3://223.5.5.5/dns-query,https://dns.alidns.com/dns-query
doh-skip-cert-verification = true
encrypted-dns-follow-outbound-mode = false
encrypted-dns-skip-cert-verification = false
use-local-host-item-for-proxy = true
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
read-etc-hosts = true
# Always Real IP Hosts
always-real-ip = *.lan, cable.auth.com, *.msftconnecttest.com, *.msftncsi.com, network-test.debian.org, detectportal.firefox.com, resolver1.opendns.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, stun.*, global.turn.twilio.com, global.stun.twilio.com, localhost.*.qq.com, *.logon.battlenet.com.cn, *.logon.battle.net, *.blzstatic.cn, music.163.com, *.music.163.com, *.126.net, musicapi.taihe.com, music.taihe.com, songsearch.kugou.com, trackercdn.kugou.com, *.kuwo.cn, api-jooxtt.sanook.com, api.joox.com, joox.com, y.qq.com, *.y.qq.com, streamoc.music.tc.qq.com, mobileoc.music.tc.qq.com, isure.stream.qqmusic.qq.com, dl.stream.qqmusic.qq.com, aqqmusic.tc.qq.com, amobile.music.tc.qq.com, *.xiami.com, *.music.migu.cn, music.migu.cn, proxy.golang.org, *.mcdn.bilivideo.cn, *.cmpassport.com, id6.me, open.e.189.cn, mdn.open.wo.cn, opencloud.wostore.cn, auth.wosms.cn, *.jegotrip.com.cn, *.icitymobile.mobi, *.pingan.com.cn, *.cmbchina.com, pool.ntp.org, *.pool.ntp.org, ntp.*.com, time.*.com, ntp?.*.com, time?.*.com, time.*.gov, time.*.edu.cn, *.ntp.org.cn, PDC._msDCS.*.*, DC._msDCS.*.*, GC._msDCS.*.*
# 日志等级
loglevel = notify
# VIF Included Routes
# tun-included-routes = 192.168.1.12/32
# include-all-networks = false
# include-local-networks = false
# 排除简单主机名
exclude-simple-hostnames = true
# UDP
udp-policy-not-supported-behaviour = REJECT
udp-priority = true
# 当遇到 REJECT 策略时显示错误页
show-error-page-for-reject = true
# 跳过代理
skip-proxy = localhost, *.local, 10.0.0.0/8, 100.64.0.0/10, 127.0.0.1/32, 169.254.0.0/16, 172.16.0.0/12, 192.168.0.0/16,192.168.122.1/32, 193.168.0.1/32, 224.0.0.0/4, 240.0.0.0/4, 255.255.255.255/32, *.crashlytics.com, passenger.t3go.cn, captive.apple.com, seed-sequoia.siri.apple.com, sequoia.apple.com, injections.adguard.org, local.adguard.org
include-all-networks = false
# TCP Fast Open Behaviour
# TYPE: tfo-behaviour = auto
include-local-networks = false

[Replica]
hide-apple-request = false
hide-crash-reporter-request = true
hide-udp = false

[Proxy Group]
# 𝐏𝐫𝐨𝐱𝐲 = select, policy-path=订阅链接
𝐏𝐫𝐨𝐱𝐲 = select, 🇭🇰HK, 🇨🇳TW, 🇯🇵JP, 🇸🇬SG, 🇺🇸US, 🇪🇺EU, 🤍
Netflix = select, 🇭🇰HK, 🇨🇳TW, 🇯🇵JP, 🇸🇬SG, 🇺🇸US, 🤍
Streaming = select, Xiao's, 🇭🇰HK, 🇨🇳TW, 🇯🇵JP, 🇸🇬SG, 🇺🇸US, 🇪🇺EU, 🤍
Global = select, Xiao's, 🇭🇰HK, 🇨🇳TW, 🇯🇵JP, 🇸🇬SG, 🇺🇸US, 🇪🇺EU, 🤍
Game = select, DIRECT, Xiao's, 🇭🇰HK, 🇨🇳TW, 🇯🇵JP, 🇸🇬SG, 🇺🇸US, 🇪🇺EU, 🤍
PayPal = select, DIRECT, 🇭🇰HK, 🇺🇸US
𝐀𝐩𝐩𝐥𝐞 = select, DIRECT, 🇺🇸US, Xiao's, 🇪🇺EU, 🤍
🇭🇰HK = load-balance, policy-path=订阅链接, nterval=600, tolerance=50, update-interval=86400, policy-regex-filter=(🇭🇰|港|Hong|HK), persistent=1, no-alert=0, hidden=0, include-all-proxies=0
🇸🇬SG = load-balance, policy-path=订阅链接, interval=600, tolerance=50, update-interval=86400, policy-regex-filter=(🇸🇬|新加坡|Singapore|SG), persistent=1, no-alert=0, hidden=0, include-all-proxies=0
🇨🇳TW = load-balance, policy-path=订阅链接, interval=600, tolerance=50, update-interval=86400, policy-regex-filter=(🇨🇳|台湾|Tai|TW), persistent=1, no-alert=0, hidden=0, include-all-proxies=0
🇯🇵JP = load-balance, policy-path=订阅链接, interval=600, tolerance=50, update-interval=86400, policy-regex-filter=(🇯🇵|日本|Japan|JP), persistent=1, no-alert=0, hidden=0, include-all-proxies=0
🇺🇸US = load-balance, policy-path=订阅链接, interval=600, tolerance=50, update-interval=86400, policy-regex-filter=(🇺🇸|美国|States|US), persistent=1, no-alert=0, hidden=0, include-all-proxies=0
🇪🇺EU = select, policy-path=订阅链接, update-interval=86400, policy-regex-filter=(🇷🇺|🇺🇦|🇲🇩|🇪🇪|🇱🇻|🇱🇹|🇨🇿|🇸🇰|🇭🇺|🇵🇱|🇮🇪|🇬🇧|🇧🇪|🇳🇱|🇫🇷|🇱🇺|🇩🇪|🇲🇨|🇦🇹|🇨🇭|🇱🇮|🇮🇸|🇩🇰|🇫🇮|🇳🇴|🇸🇪|🇵🇹|🇪🇸|🇧🇬|🇬🇷|🇻🇦|🇦🇩|🇷🇴|🇲🇹|🇸🇮|🇭🇷|🇷🇸|🇲🇰|🇲🇪|🇧🇦|🇦🇱|🇨🇾|🇮🇹|🇷🇪)
🤍 = select, policy-path=订阅链接, update-interval=86400, policy-regex-filter=(🇲🇴|🇵🇭|🇮🇩|🇰🇭|🇮🇳|🇯🇴|🇮🇷|🇮🇱|🇹🇷|🇦🇺|🇪🇬|🇿🇦|🇨🇦|🇲🇾|🇹🇭|🇰🇷|🇻🇳|🇲🇳|🇧🇭|🇳🇵|🇧🇩|🇦🇪|🇦🇲|🇬🇪|🇵🇰|🇰🇿|🇰🇬|🇺🇿|🇲🇽|🇵🇦|🇵🇷|🇨🇷|🇧🇷|🇨🇱|🇵🇪|🇦🇷|🇺🇾|🇨🇼|🇵🇾|🇨🇴|🇻🇪|🇬🇹|🇪🇬|🇲🇦|🇹🇳|🇱🇾|🇰🇪|🇳🇬|🇲🇺|🇳🇿)
Final = select, DIRECT, Xiao's

[Rule]
# 高德
DOMAIN,amdc.m.taobao.com,Reject
# misakaF公益服
DOMAIN-KEYWORD,misakaf,DIRECT
# Google
AND,((PROTOCOL,UDP), (DEST-PORT,443)),REJECT-NO-DROP
AND,((PROTOCOL,UDP), (DOMAIN-SUFFIX,googlevideo.com)),REJECT-NO-DROP
# IP Check
DOMAIN,ip-api.com,Xiao's
# Safari 防跳转
# DOMAIN,app-site-association.cdn-apple.com,Reject
# Boxjs 代理
DOMAIN-KEYWORD,jsdelivr.net,Xiao's
# Sub-Store 的 Web 页面
DOMAIN-SUFFIX,vercel.app,Xiao's
# Client(仅 macOS)
PROCESS-NAME,UUBooster,DIRECT
# > Download (仅 macOS)
PROCESS-NAME,aria2c,DIRECT
PROCESS-NAME,fdm,DIRECT
PROCESS-NAME,Folx,DIRECT
PROCESS-NAME,NetTransport,DIRECT
PROCESS-NAME,Thunder,DIRECT
PROCESS-NAME,Transmission,DIRECT
PROCESS-NAME,uTorrent,DIRECT
PROCESS-NAME,WebTorrent,DIRECT
PROCESS-NAME,WebTorrent Helper,DIRECT
# BT
DOMAIN-SUFFIX,smtp,DIRECT
DOMAIN-KEYWORD,aria2,DIRECT
DOMAIN-KEYWORD,announce,DIRECT
DOMAIN-KEYWORD,torrent,DIRECT
DOMAIN-KEYWORD,tracker,DIRECT
URL-REGEX,(Subject|HELO|SMTP),DIRECT
URL-REGEX,(api|ps|sv|offnavi|newvector|ulog.imap|newloc)(.map|).(baidu|n.shifen).com,DIRECT
# 迅雷
URL-REGEX,(.?)(xunlei|sandai|Thunder|XLLiveUD)(.),DIRECT
DOMAIN-SUFFIX,xunlei.com,DIRECT
PROCESS-NAME,DownloadService,DIRECT
PROCESS-NAME,Weiyun,DIRECT
PROCESS-NAME,baidunetdisk,DIRECT
URL-REGEX,(api|ps|sv|offnavi|newvector|ulog\.imap|newloc)(\.map|)\.(baidu|n\.shifen)\.com,DIRECT
# 后续规则修正
# RULE-SET,https://raw.githubusercontent.com/JupiterH/Surge/main/Rule/Direct.list,DIRECT
# RULE-SET,https://raw.githubusercontent.com/JupiterH/Surge/main/Rule/Reject.list,REJECT
# 广告拦截
# RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Advertising/Advertising.list,REJECT
DOMAIN-SET,https://anti-ad.net/surge2.txt,REJECT
# 隐私保护
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Privacy/Privacy.list,REJECT
DOMAIN-SET,https://github.com/blackmatrix7/ios_rule_script/blob/master/rule/Surge/Privacy/Privacy_Domain.list,REJECT
# 运营商劫持或恶意网站
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Hijacking/Hijacking.list,REJECT
# China
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/China/China.list,DIRECT
DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/China/China_Domain.list,DIRECT
# Apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list,𝐀𝐩𝐩𝐥𝐞
DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple_Domain.list,𝐀𝐩𝐩𝐥𝐞
# Netflix
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Netflix/Netflix.list,Netflix
# HBO
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/HBOAsia/HBOAsia.list,🇨🇳TW
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/HBOUSA/HBOUSA.list,🇺🇸US
# Telegram
AND,((PROCESS-NAME,Telegram), (OR,((IP-CIDR,0.0.0.0/8), (IP-CIDR,224.0.0.0/4)))),REJECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Telegram/Telegram.list,🇸🇬SG
# Game
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Game/Game.list,Game
# PayPal
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/PayPal/PayPal.list,PayPal
# 国际流媒体
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GlobalMedia/GlobalMedia.list,Streaming
DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GlobalMedia/GlobalMedia_Domain.list,Streaming
# Global
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Global/Global.list,Global
DOMAIN-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Global/Global_Domain.list,Global
# GeoIP China
RULE-SET,https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/auto-update/ruleset/ASN.China.list,DIRECT
# Local Area Network 局域网
RULE-SET,LAN,DIRECT
# 防止应用循环请求
IP-CIDR,0.0.0.0/32,REJECT,no-resolve
FINAL,Final,dns-failed

[URL Rewrite]
阻止google.com 跳转到google.com.hk header
^https?:\/\/(www\.)?g\.cn https://www.google.com/ncr 302
^https?:\/\/(www\.)?google\.cn https://www.google.com/ncr 302

[MITM]
skip-server-cert-verify = true
tcp-connection = true
h2 = true
hostname = *.google.com.hk
ca-passphrase = 
ca-p12 = 

[Script]
net-info = type=generic,timeout=30,script-path=https://raw.githubusercontent.com/JupiterH/Surge/main/Scripts/Network-Info.js
Connectivity_Test = type=generic,timeout=3,script-path=https://raw.githubusercontent.com/getsomecat/GetSomeCats/Surge/script/ConnectivityTest.js,argument=title=Connectivity Test&icon=icloud.and.arrow.down&color=#FF9F0A&server=false
network-speed = type=generic,timeout=60,script-path=https://raw.githubusercontent.com/getsomecat/GetSomeCats/Surge/script/index.js,argument=icon=arrow.down.circle&icon-color=#5d84f8&mb=1
Sub_info = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/Rabbit-Spec/Surge/Master/Module/Panel/Sub-info/Moore/Sub-info.js,script-update-interval=0,argument=url=encode订阅链接&reset_day=11&title=Kuromis&icon=tornado&color=#00FFFF
Sub_info1 = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/Rabbit-Spec/Surge/Master/Module/Panel/Sub-info/Moore/Sub-info.js,script-update-interval=0,argument=url=encode订阅链接&reset_day=26&title=TAG&icon=sparkles&color=#DC143C
stream-all = type=generic,timeout=15,script-path=https://raw.githubusercontent.com/Rabbit-Spec/Surge/Master/Module/Panel/Stream-All/Moore/Stream-All.js
节假日倒计时 = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/JupiterH/Surge/main/Scripts/Timecard.js

[Panel]
NetInfoPanel = style=info,script-name=net-info,update-interval=1
Connectivity_Test = script-name=Connectivity_Test,update-interval=1
network-speed = script-name=network-speed,update-interval=-1
Sub_info = script-name=Sub_info,update-interval=3600
Sub_info1 = script-name=Sub_info1,update-interval=3600
stream-all = script-name=stream-all,title=流媒体解锁检测,content=请刷新面板,update-interval=3600
节假日倒计时 = script-name=节假日倒计时,update-interval=600

